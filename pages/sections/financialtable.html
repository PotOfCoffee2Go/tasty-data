::div #financial-data tx-darkblue::

<script>
  markupFinancialData = () => {
    popwin.info('Markup Financial');
    let summaryMarkup =
      "::spinner #financialSpinner hidden::\n\n" +
      "Summary\n\n" +
      "| Account | Cash | Profit | Positions | Gain | Liquidate | Fees |\n" +
      "| :-----: | :--: | :----: | :-------: | :--: | :-------: | :--: |\n" +
      "| {{calc.account}} | {{calc.cash}} | {{calc.gain}} | {{calc.positions}} |" +
      " {{calc.liquidity}} | {{calc.liquidate}} | {{calc.fees}} |\n";

    let detailMarkup =
      "Account Activity\n\n" +
      "| Date | Code | Subcode | Amount |\n" +
      "| :--: | :--: | :-----: | :----: |\n" +
      "{{#data}}" +
      "| {{{fmt.Date_Time}}} | {{fmt.Code}} | {{fmt.Subcode}} | {{fmt.Amount}} |" +
      "  \n" +
      "{{/data}}" +
      "| Totals | - | - | {{cashsums.Amount}} |\n";

    const data = webdocdown.data.store.tastyFinancialData.data;
    const cashsums = webdocdown.data.store.tastyFinancialSums;
    const possums = webdocdown.data.store.tastyPositionSums;
    const calc = webdocdown.data.store.tastyFinancialSummary;

    // Sort by Date/Time
    data.sort((a, b) => (a.Time < b.Time ? 1 : -1));

    // Produce and display tables of financial data
    let tablesOutput = '';
    webdocdown
      .produceWBDD(summaryMarkup, { data, cashsums, possums, calc })
      .then((html) => tablesOutput = ('<div>' + html + '</div>'))
      .then(() => webdocdown.produceWBDD(detailMarkup, { data, cashsums, possums, calc }))
      .then((html) => tablesOutput += ('<div>' + html + '</div>'))
      .then(
        () => (document.getElementById("financial-data").innerHTML = tablesOutput)
      );
  };
</script>

<style>
  #financial-data table,
  #financial-data th,
  #financial-data td {
    padding: 4px;
    border: 1px solid black;
    border-collapse: collapse;
  }
  #financial-data table {
    margin-left: auto;
    margin-right: auto;
  }
  #financial-data th {
    color: black;
  }
  #financial-data tbody tr:last-child {
    background: #e8e8e8;
  }
  #financial-data tr td a {
    cursor: pointer;
  }
</style>
